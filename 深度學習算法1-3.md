# 深度學習算法1-3

[toc]
<!-- toc --> 


# Motion detection

## QuaterNet

- [[1805.06485] QuaterNet: A Quaternion-based Recurrent Model for Human Motion](https://arxiv.org/abs/1805.06485)

    - [facebookresearch/QuaterNet: Proposes neural networks that can generate animation of virtual characters for different actions.](https://github.com/facebookresearch/QuaterNet)

# Sequence_prediction

## 太陽黑子預測

- [Time Series Deep Learning, Part 1: Forecasting Sunspots With Keras Stateful LSTM In R](http://www.business-science.io/timeseries-analysis/2018/04/18/keras-lstm-sunspots-time-series-prediction.html)
- [Time Series Deep Learning, Part 2: Predicting Sunspot Frequency with Keras LSTM In R](http://www.business-science.io/timeseries-analysis/2018/07/01/keras-lstm-sunspots-part2.html)

## CNN+RNN

- [Combining CNNs and RNNs – Crazy or Genius? - Data Science Central](https://www.datasciencecentral.com/profiles/blogs/combining-cnns-and-rnns-crazy-or-genius)

    > There are things that just don't seem to go together.  Take oil and water for instance.  Both valuable, but try putting them together? 
    > 
    > That was my reaction when I first came across the idea of combining CNNs (convolutional neural nets) and RNNs (recurrent neural nets).  After all they're optimized for completely different problem types.
    > 
    > -   **CNNs** are good with hierarchical or spatial data and extracting unlabeled features. Those could be images or written characters.  CNNs take fixed size inputs and generate fixed size outputs.
    > -   **RNNs** are good at temporal or otherwise sequential data. Could be letters or words in a body of text, stock market data, or speech recognition.  RNNs can input and output arbitrary lengths of data.  LSTMs are a variant of RNNs that allow for controlling how much of prior training data should be remembered, or more appropriately forgotten.
    > 
    > We all know to reach for the appropriate tool based on these very unique problem types.
    > 
    > **So are there problem types that need the capability of both these tools?**
    > 
    > [![](https://api.ning.com/files/2sIBZeVc-HK0kJHviuClGiSw2rukTzwuMt0i33WB69KvR6Xww9TrrLbguqPYL7HmHhwGMQ7FifHWrLjVj5F-8HQO9AjpV0xM/CRFCNNRNNFusion.png?width=250)](https://api.ning.com/files/2sIBZeVc-HK0kJHviuClGiSw2rukTzwuMt0i33WB69KvR6Xww9TrrLbguqPYL7HmHhwGMQ7FifHWrLjVj5F-8HQO9AjpV0xM/CRFCNNRNNFusion.png)
    > As it turns out, yes.  Most of these are readily identified as images that occur in a temporal sequence, in other words video.  But there are some other clever applications not directly related to video that may spark your imagination.  We'll describe several of those below.
    > 
    > There are also several emerging models of how to combine these tools.  In most cases CNNs and RNNs have been married as separate layers with the output of the CNN being used as input to the RNN.  But there are some researchers cleverly combining these two capabilities within a single deep neural net. 
    > 
    > **Video Scene Labeling**
    > 
    > The classical approach to scene labeling is to train a CNN to identify and classify the objects within a frame and perhaps to further classify the objects into a higher level logical group.  For example, the CNN identifies a stove, a refrigerator, a sink, etc. and also up-classifies them as a kitchen.
    > 
    > Clearly the element that's missing is the meaning of the motion over several frames (time).  For example, several frames of a game of pool might correctly say, the shooter sinks the eight ball in the side pocket.  Or several frames of a young person learning to ride a two-wheeler followed by the frame of the rider on the ground, might reasonably be summarized as 'boy falls off bike'.
    > 
    > Researchers have used layered CNN-RNN pairs where the output of the CNN is input to the RNN.  Logically the RNN has also been replaced with LSTMs to create a more 'in the moment' description of each video segment.  Finally there has been some experimentation done with combined RCNNs where the recurrent connection is directly in the kernels as in the diagram above.  See more [*here*](http://proceedings.mlr.press/v32/pinheiro14.pdf).
    > 
    > **Emotion Detection**
    > 
    > Judging the emotion of individuals or groups of individuals from video remains a challenge.  There is an annual competition around this held by the ACM International Conference on Multimodal Interaction known as the EmotiW Grand Challenge.
    > 
    > Each year the target data changes somewhat in nature and typically there are different tests for classifying groups of people versus individuals appearing in videos.
    > 
    > 2016: Group based happiness intensity.
    > 
    > 2017: Group based three class (positive/neutral/negative) emotion detection.
    > 
    > 2018 (scheduled for November) is even more complex.  The challenge will involve classification of eating conditions.  There are three sub-challenges:
    > 
    > 1.  Food-type Sub-Challenge: Perform seven-class food classification per utterance.
    > 2.  Food-likability Sub-Challenge: Recognize the subjects' food likability rating.
    > 3.  Chew and Speak Sub-Challenge: Recognize the level of difficulty to speak while eating.
    > 
    > The key to this challenge is not only the combination of CNNs and RNNs but also the inclusion of an audio track that can be separately modeled and integrated. 
    > 
    > In 2016 the winners created a hybrid network consisting of a RNN and 3D convolutional networks (C3D).  Data fusion and classification takes place late in the process as is traditional.  The RNN takes appearance features extracted by the CNN from individual frames as input and encodes motion later, while C3D models appearance and motion of video simultaneously, subsequently also merged with the audio module. 
    > 
    > Accuracy in this very difficult field still isn't great.  The 2016 winners scored 59.02% on the individual faces.  By 2017 the individual face scores were up to 60.34% and the group scores were up to 80.89% -- keeping in mind that the nature of the challenge changes each year so year-over-year comparison isn't possible.  More on this annual challenge [*here*](https://icmi.acm.org/2018/index.php?id=challenges).
    > 
    > **Video Based Person Re-identification / Gait Recognition**
    > 
    > The goal here is to identify a person when seen in video (from a database of existing labeled individuals) or simply to recognize if this person has been seen before (re-identification -- not labeled).  The dominant line of research has been in gait recognition and the evolving field uses full body motion recognition (arm swing, limps, carriage, etc.).
    > 
    > [![](https://api.ning.com/files/2sIBZeVc-HIN4Zq6aiFj2hMBNjX9p1WRwf*iIu76zefF1t7uVKzPlFe0mCvzccJfMFTiid6wDjUmS-8PpSPbwf9M1mSN59SV/fullbodyrecognition.png?width=250)](https://api.ning.com/files/2sIBZeVc-HIN4Zq6aiFj2hMBNjX9p1WRwf*iIu76zefF1t7uVKzPlFe0mCvzccJfMFTiid6wDjUmS-8PpSPbwf9M1mSN59SV/fullbodyrecognition.png)There are some evident non-technical challenges here the most obvious being change in clothing, shoes, partial obscurity from coats or packages, and the like.  The technical problems well known in CNN are multiple viewpoints (in fact multiple view points as a single person passes say from right to left offering first front, then side, then back views) and the classical image problems of lighting, albedo, and size.
    > 
    > Prior efforts were based on combining several frames of CNN derived data representing one full step (gait) into a type of heat map called a Gait Energy Image (GEI).
    > 
    > Addition of an LSTM allowed several 'steps' to be analyzed together and the time series capability of the LSTM works as a frame-to-frame view transformation models to adjust for perspective.
    > 
    > This study including the image can be found [*here*](https://vision.unipv.it/CV/materiale2016-17/3rd%20Choice/0213.pdf).  Not surprisingly given the application to surveillance, gait recognition has the highest number of cited research papers, almost all of which are being conducted in China.
    > 
    > Full human pose recognition, both for recognition and for labeling (the person is standing, jumping, sitting, etc.) is the next frontier with separate convolutional models for each body part.  Gesture recognition as part of a UI especially in augmented reality is becoming a hot topic.
    > 
    >  [![](https://api.ning.com/files/2sIBZeVc-HJLKZxxKFxF0FHTQNKo9okXYyjUAsPzCPmN15kI3sUgbioJgfdzyrcYKmYMxBBUY2t7oz6oFdPVOgwsJ0ydKVNt/gesturerecognition.png?width=500)](https://api.ning.com/files/2sIBZeVc-HJLKZxxKFxF0FHTQNKo9okXYyjUAsPzCPmN15kI3sUgbioJgfdzyrcYKmYMxBBUY2t7oz6oFdPVOgwsJ0ydKVNt/gesturerecognition.png)
    > 
    > **Weather Prediction**
    > 
    > The objective is to predict the intensity of rainfall over a localized region and over a fairly short time span.  This field is known as 'nowcasting'.
    > 
    > **Quantifying the Functions of DNA Sequences**
    > 
    > Some 98% of human DNA is non-coding, known as Introns.  Originally thought to be evolutionary leftovers with no value, geneticists now know that for example 93% of disease associated variants lie in these regions.  Modeling properties and functions of these regions is an ongoing challenge recently made somewhat easier by a combination CNN/LSTM called DanQ.
    > 
    > According to the developers "the convolution layer captures regulatory motifs, while the recurrent layer captures long-term dependencies between the motifs in order to learn a regulatory 'grammar' to improve predictions. DanQ improves considerably upon other models across several metrics. For some regulatory markers, DanQ can achieve over a 50% relative improvement in the area under the precision-recall curve metric compared to related models."  The study is [*here*](https://academic.oup.com/nar/article/44/11/e107/2468300).
    > 
    > **Creating Realistic Sound Tracks for Silent Videos**
    > 
    > MIT researchers created an extensive collection of labeled sound clips of drumsticks hitting pretty much everything they could think of.  Using a combined CNN/LSTM, the CNN identifies the visual context (what the drumstick is hitting in the silent video) but since the sound clip is temporal and extends over several frames, the LSTM layer is used to match the sound clip to the appropriate frames.
    > 
    > The developers report that humans were fooled by the predicted sound match more than 50% of the time.  See video [*here*](https://www.youtube.com/watch?t=0s&v=flOevlA9RyQ).
    > 
    > **Future Direction**
    > 
    > I was surprised to find such a wealth of examples in which researchers combine CNNs and RNNs to gain the advantages of both.  There are even some [*studies utilizing GANs*](http://openaccess.thecvf.com/content_cvpr_2018/papers/Liu_Multi-Task_Adversarial_Network_CVPR_2018_paper.pdf) in hybrid networks that are quite interesting.
    > 
    > However, while these mashups seem to provide additional capabilities there is another, newer and perhaps more prominent line of research that says that CNNs alone can do the job and that the days of RNNs/LSTMs are numbered.
    > 
    > One group of researchers used [*a novel architecture of deep forests*](https://www.datasciencecentral.com/profiles/blogs/off-the-beaten-path-using-deep-forests-to-outperform-cnns-and-rnn) embedded in a node structure to outperform CNNs and RNNs, with significant savings in compute and complexity.
    > 
    > We also reviewed the more mainstream movement by both Facebook and Google who recently abandoned their RNN/LSTM based tools for speech-to-speech translation in favor of [*Temporal Convolutional Nets (TCNs)*](https://www.datasciencecentral.com/profiles/blogs/temporal-convolutional-nets-tcns-take-over-from-rnns-for-nlp-pred). 
    > 
    > Especially in text problems, but more generally in any time series problem RNNs have an inherent design problem.  Because they read and interpret the input text one word (or character or image) at a time, the deep neural network must wait to process the next word until the current word processing is complete. 
    > 
    > This means that RNNs cannot take advantage of massive parallel processing (MPP) in the same way the CNNs can.  Especially true when the RNN/LSTMs are running both ways at once to better understand context. 
    > 
    > This is a barrier that won't go away and seems to place an absolute limit on the utility of RNN/LSTM architecture.  Temporal Convolutional Neural Nets get around this by using CNN architecture which can easily use MPP acceleration with the emerging concepts of attention and gate hopping.  For more detail [*please see our original article*](https://www.datasciencecentral.com/profiles/blogs/temporal-convolutional-nets-tcns-take-over-from-rnns-for-nlp-pred).
    > 
    > I'm certainly not one to write off an entire line of research, especially where the need for minimum latency is not as severe as speech-to-speech translation.  However, all of these problems described above do seem ripe for a repeated examination using this newer methodology of TCNs.
    > 
    > [*Other articles by Bill Vorhies.*](https://www.datasciencecentral.com/profiles/blog/list?user=0h5qapp2gbuf8)
    > 


## TCN

- [Temporal Convolutional Nets (TCNs) Take Over from RNNs for NLP Predictions - Data Science Central](https://www.datasciencecentral.com/profiles/blogs/temporal-convolutional-nets-tcns-take-over-from-rnns-for-nlp-pred)

    > It's only been since 2014 or 2015 when our DNN-powered applications passed the 95% accuracy point on text and speech recognition allowing for whole generations of chatbots, personal assistants, and instant translators.
    > 
    > Convolutional Neural Nets (CNNs) are the acknowledged workhorse of image and video recognition while Recurrent Neural Nets (RNNs) became the same for all things language.
    > 
    > One of the key differences is that CNNs can recognize features in static images (or video when considered one frame at a time) while RNNs exceled at text and speech which were recognized as sequence or time-dependent problems.  That is where the next predicted character or word or phrase depends on those that came before (left-to-right) introducing the concept of time and therefore sequence.
    > 
    > Actually RNNs are good at all types of sequence problems, including speech/text recognition, language-to-language translation, handwriting recognition, sequence data analysis (forecasting), and even automatic code generation in many different configurations.
    > 
    >  [![](https://api.ning.com/files/iIlSVBG0bp*u5kZnSvL5xoCLJw960*axGU6QL0FMjjbTKTe*khoLLvb12qFTL2zQgGK5VwFgNY8qnQEVk50A6CvZxmwBRsxt/rnndiagrams.jpeg?width=500)](https://api.ning.com/files/iIlSVBG0bp*u5kZnSvL5xoCLJw960*axGU6QL0FMjjbTKTe*khoLLvb12qFTL2zQgGK5VwFgNY8qnQEVk50A6CvZxmwBRsxt/rnndiagrams.jpeg)
    > 
    > In a very short period of time, major improvements to RNNs became dominant including LSTM (long short term memory) and GRU (gated recurring units) both of which improved the span over which RNNs could remember and incorporate data far from the immediate text into its meaning.
    > 
    > **Solving the 'Not' Joke Problem**
    > 
    > With RNNs reading characters or words from left-to-right in time, context became a problem.  For example, in trying to predict the sentiment of a review, the first few comments might be positive (e.g. good food, good atmosphere) but might end with several negative comments (e.g. terrible service, high price) that might ultimately mean the review was negative.  This is the logical equivalent of the 'Not' joke.  'That's a great looking tie. NOT!'.
    > 
    > The solution was to read the text in both directions at once by having two LSTM encoder working at once (bi-directional encoders).  This meant having information from the future (further down the text) leaking into the present but it largely solved the problem.  Accuracy improved.
    > 
    > **Facebook and Google Have a Problem**
    > 
    > Early on when Facebook and Google were launching their automatic language translators, they realized they had a problem.  The translations were taking too long.
    > 
    > RNNs have an inherent design problem.  Because they read and interpret the input text one word (or character) at a time, the deep neural network must wait to process the next word until the current word processing is complete. 
    > 
    > This means that RNNs cannot take advantage of massive parallel processing (MPP) in the same way the CNNs can.  Especially true when the RNN/LSTMs are running both ways at once to better understand context. 
    > 
    > It also means they are very compute intensive since all the intermediate results must be stored until the processing of the entire phrase is complete.
    > 
    > In early 2017 both Google and Facebook came to similar solutions, a way to use CNNs with their MPP capability to process text for language-to-language translation.  In CNNs the computation doesn't rely on information from the previous time step, freeing each computation to be conducted separately with massive parallelization.
    > 
    > Google's solution is called ByteNet, Facebook's is FairSeq (named after their internal Facebook Artificial Intelligence Research (FAIR) team.  FairSeq is available on GitHub.
    > 
    > Facebook says their FairSeq net runs 9X faster than their RNN benchmark.
    > 
    > **How Does It Work -- The Basics**
    > 
    > Thinking about CNNs and how they process images as a 2D 'patch' (height and width), making the jump to text requires only that you think of text as a 1D object (1 unit high and *n* units long). 
    > 
    > But while RNNs do not directly predefine object length, CNNs do so by definition.  So using CNNs requires us to add more layers until the entire receptive field is covered.  This can and does result in very deep CNNs, but with the advantage being, no matter how deep, each can be processed separately in parallel for the huge time savings.
    > 
    > **The Special Sauce: Gating + Hopping = Attention**
    > 
    > Of course it's not quite as simple as that and both the Google and Facebook techniques add something called an 'Attention' function.
    > 
    > The original Attention function appears to have been introduced last year by researchers at Google Brain and the University of Toronto under the name Transformer.  [*Read the original*](https://papers.nips.cc/paper/7181-attention-is-all-you-need.pdf) research paper here.
    > 
    > By the time the basically identical function was adopted by both Facebook and Google it had become the 'Attention' function which has two unique features.
    > 
    > The first is identified by Facebook as 'multi-hoping'.  Rather than the traditional RNN approach of looking at the sentence only once, multi-hoping allows the system to take multiple 'glimpses' of the sentence in a manner more like human translators. 
    > 
    > Each glimpse might focus on a noun or verb, not necessarily in sequence, which offers the most insight into meaning for that pass.  Glimpses might be independent or might be dependent on the previous look to then focus on a related adjective, adverb, or auxiliary verb.
    > 
    > [![](https://api.ning.com/files/iIlSVBG0bp9*sLbkNQbbly2DmvOsRMirzdj5nhO67J1SmbrWC-KBffhPyE87*Juq2RtNFZg7gdm1OdCxiwpYmaw-yBKaJ61n/Facebookhopping.png?width=350)](https://api.ning.com/files/iIlSVBG0bp9*sLbkNQbbly2DmvOsRMirzdj5nhO67J1SmbrWC-KBffhPyE87*Juq2RtNFZg7gdm1OdCxiwpYmaw-yBKaJ61n/Facebookhopping.png)Facebook offers this illustration to show the first pass of the French-to-English translation is a single pass to encode each French word, then the multi-hoping routine of the decoder to select the most appropriate English translation.
    > 
    > The second feature is gating which controls the information flow between the hidden layers.  Gating determines what information best produces the next word by essentially allowing the CNN to zoom in or out on the translation in process to achieve the best context for making the next decision.
    > 
    > **Beyond Language Translation -- Temporal Convolutional Nets (TCNs)**
    > 
    > By mid-2017 Facebook and Google had solved the problem of speed of translation by using CNNs combined with the attention function.  The larger question however was this technique good for more than just speeding up translation.  Should we be looking at all the problem types previously assumed to be solvable only with RNNs?  And the answer of course is yes.
    > 
    > There were a number of studies published in 2017; some coming out literally at the same time that Facebook and Google published.  One which does a good job of covering the broader question of what's beyond translation is "An Empirical Evaluation of Generic Convolutional and Recurrent Networks for Sequence Modeling" by Shaojie Bai, J. Zico Kolter, and Vladlen Koltun ([*original here*](https://arxiv.org/pdf/1803.01271.pdf)). 
    > 
    > These are the folks who have labeled this new architecture **Temporal Convolutional Nets (TCNs)** though it's possible that may change as the industry continues to implement them.
    > 
    > Their study is a series of head-to-head benchmark competitions of TCNs versus RNNs, LSTMs, and GRUs across 11 different industry standard RNN problems well beyond language-to-language translation. 
    > 
    > Their conclusion: TCNs are not only faster but also produced greater accuracy in 9 cases and tied in one *(bold figures in the table below drawn from the original study).* [![](https://api.ning.com/files/iIlSVBG0bp-rJSpXg2IE30wWWGbot5GDeBw8WMEgz7zvzWDSQOuqYUHC83KhEvFNgB6mmDPwrN2DYesV4vdgSgX*NsbaXdzo/TCNbenchmarks.png?width=400)](https://api.ning.com/files/iIlSVBG0bp-rJSpXg2IE30wWWGbot5GDeBw8WMEgz7zvzWDSQOuqYUHC83KhEvFNgB6mmDPwrN2DYesV4vdgSgX*NsbaXdzo/TCNbenchmarks.png)
    > 
    > **TCN Advantages / Disadvantages**
    > 
    > Shaojie Bai, J. Zico Kolter, and Vladlen Koltun also provide this useful list of advantages and disadvantages of TCNs.
    > 
    > -   Speed is important. Faster networks shorten the feedback cycle.  The massive parallelism available with TCNs shortens both training and evaluation cycles.
    > -   TCNs offer more flexibility in changing its receptive field size, principally by stacking more convolutional layers, using larger dilation factors, or increasing filter size. This offers better control of the model's memory size.
    > -   TCNs have a backpropagation path different from the temporal direction of the sequence. This avoids the problem of exploding or vanishing gradients which are a major issue with RNNs.
    > -   Lower memory requirement for training, especially in the case of long input sequences.
    > 
    > However, the researchers note that TCNs may not be as easy to adapt to transfer learning as regular CNN applications because different domains can have different requirements on the amount of history the model needs in order to predict. Therefore, when transferring a model from a domain where only little memory is needed to a domain where much longer memory is required, the TCN may perform poorly for not having a sufficiently large receptive field.
    > 
    > **Going Forward**
    > 
    > TCNs have been implemented in major applications with significant benefits that appear to apply across all types of sequence problems.  We'll need to rethink our assumption that sequence problems are exclusively the domain of RNNs and begin to think of TCNs as the natural starting point for our future projects.


# Machine Learning Sorting

## 用機器學習構建O(N)複雜度的排序算法

- [用機器學習構建O(N)複雜度的排序算法，可在GPU和TPU上加速計算 - 幫趣](http://bangqu.com/6vV731.html)

# Audio

## Audio GAN

- [wavegan/README.md at master · chrisdonahue/wavegan](https://github.com/chrisdonahue/wavegan/blob/master/README.md)

## Music style transfer

### Midi file
- [Free Midi Music Songs Download - FreeMidi.org](https://freemidi.org/)

### paper

- [[1805.07848] A Universal Music Translation Network](https://arxiv.org/abs/1805.07848)

    <iframe width="560" height="315" src="https://www.youtube.com/embed/vdxCqNWTpUs" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
    
    - [[R] A Universal Music Translation Network：MachineLearning](https://www.reddit.com/r/MachineLearning/comments/8lhrjf/r_a_universal_music_translation_network/)

    - [Paper Reading - A Universal Music Translation Network, from Facebook AI Research](https://medium.com/@bryanw/paper-reading-a-universal-music-translation-network-from-facebook-ai-rearch-754b4d645baa)


# Computer Graphics 電腦圖學


## Raytracing

- [Microsoft 發表 DirectX 12 Raytracing API 功能集 DXR，標準化光追蹤步驟 | T客邦 - 我只推薦好東西](https://www.techbang.com/posts/57408-microsoft-publishes-the-directx-raytracing-api-feature-set-dxr-standard-light-tracing-steps)

    > 若要瞭解光追蹤的成像原理，我們先來理解目前絕大部分 3D 遊戲畫面是如何繪製的。由於即時遊戲畫面需要每秒提供 30 張～60 張以上的畫面更新速率，因而需要 1 種相當有效率且易於平行運算的作業方式，Rasterization 光柵化就是目前 3D 遊戲的基礎。
    > 
    > 光柵化簡而言之就是把 3D 虛擬空間裡的所有物件，剃除視角以外的物件，也把被其它物件遮擋，物件背面部分全部刪除減少實際運算量（Z-buffer Culling），再壓縮至 1 張平面，而這平面就是你我所能看見的螢幕，接著再依據每個像素進行相關的貼圖、上色、打光作業。雖然這種方式能夠大量減少運算工作，同時產生不錯的畫面品質，卻也因為少了一些物件以及光線之間的交互作用，看起來與真實世界總有不小的差距。
    > 
    > 之後加入許多增進畫面品質的運算技巧，譬如 Bump Mapping 凹圖貼圖、Normal Mapping 法線貼圖、Parallax Mapping 視差貼圖、Global Illumination 全域照明、Ambient Occlusion 環境遮蔽等，都是為了加強畫面的品質與真實性。
    > 
    > ![](https://cdn0-techbang.pixfs.net/system/images/433803/original/29969e87bdc0ede4cb638c8cefc892e6.png?1521497551)  
    > ▲光柵化逐步剃除物件的步驟，由上而下分別為無剃除、剔除視錐以外物件、刪去視角以外部分、刪去背部看不見部分、刪去被其它物件遮蔽部分。
    > 
    > ![](https://cdn2-techbang.pixfs.net/system/images/433801/original/a59f717c9536fa56df1f77e5b266dd2d.png?1521497395)  
    > ▲三角形光柵化的效果。
    > 
    > Raytracing 光追蹤則是模擬真實世界光線運作方式，包含光在物體表面的折射、散射、繞射，或是穿過物體的透射，同時考慮到光在各個物體之間的交互作用，也就是計算場景的光場，最終以平面方式呈現在螢幕。為了減少運算量，實際上運算步驟並不從光源開始，而是由攝影機視角反向射出數條虛擬光線，追蹤這些虛擬光線的路徑。
    > 
    > ![](https://cdn2-techbang.pixfs.net/system/images/433804/original/e6f6301fb1078457ec0b633ca3280d37.png?1521497585)  
    > ▲光追蹤可以計算物件與物件之間的光線交互作用。
    > 
    > 因為內部原理與實際環境相當類似，光追蹤可以產生相當逼真的畫面效果，無需其它特殊的運算技巧。但是相對於光柵化還是需要相當大的運算資源，因此 3D 遊戲絕大部分依然選用光柵作為產生畫面的手段，光追蹤則是應用在動畫、電影特效等沒有時間限制的領域。部分遊戲貼圖材質也會先行以光追蹤技法處理，預先改變顏色後再貼上物件，產生較為逼真的結果。
    > 
    - [Announcing Microsoft DirectX Raytracing! – DirectX Developer Blog](https://blogs.msdn.microsoft.com/directx/2018/03/19/announcing-microsoft-directx-raytracing/)

- [What's the Difference Between Ray Tracing, Rasterization? | NVIDIA Blog](https://blogs.nvidia.com/blog/2018/03/19/whats-difference-between-ray-tracing-rasterization/)




## GPU Rendering process

- [graphics card - Why are videos rendered by the cpu instead of the gpu? - Super User](https://superuser.com/questions/790418/why-are-videos-rendered-by-the-cpu-instead-of-the-gpu)

    > Before HD was a thing, CPUs could handle video decoding easily. When HD became popular about 8 years ago, GPU manufacturers started to implement accelerated video decoding in their chips. You could easily find graphics cards marketed as supporting HD videos and some other slogans. Today any GPU supports accelerated video, even integrated GPUs like Intel HD Graphics or their predecessors, Intel GMA. Without that addition your CPU would have a hard time trying to digest 1080p video with acceptable framerate, not to mention increased energy consumption. So you're already using accelerated video everyday.
    > 
    > Now when GPUs have more and more general use computational power, they are widely used to accelerate video processing too. This trend started around the same time when accelerated decoding was introduced. Programs like Badaboom started to gain popularity as it turned out that GPUs are much better at (re)encoding video than CPUs. It couldn't be done before, though, because GPUs lacked generic computational abilities.
    > 
    > But GPUs could already scale, rotate and transform pictures since middle ages, so why weren't we able to use these features for video processing? Well, these features were never implemented to be used in such way, so they were suboptimal for various reasons.
    > 
    > When you program a game, you first upload all graphics, effects etc. to the GPU and then you just render polygons and map appropriate objects to them. You don't have to send textures each time they are needed, you can load them and reuse them. **When it comes to video processing, you have to constantly feed frames to the GPU, process them and fetch them back to reencode them on CPU (remember, we're talking about pre-computational-GPU times)**. This wasn't how GPUs were supposed to work, so performance wasn't great.
    > 
    > Another thing is, **GPUs aren't quality-oriented when it comes to image transformations**. When you're playing a game at 40+ fps, you won't really notice slight pixel misrepresentations. Even if you would, game graphics weren't detailed enough for people to care. There are various hacks and tricks used to speed up rendering that can slightly affect quality. **Videos are played at rather high framerates too, so scaling them dynamically at playback is acceptable, but reencoding or rendering has to produce results that are pixel-perfect or at least as close as possible at reasonable cost.** You can't achieve that without proper features implemented directly in GPU.
    > 
    > Nowadays using GPUs to process videos is quite common because we have required technology in place. Why it's not the default choice is rather a question to program's publisher, not us - it's their choice. Maybe they believe that their clients have hardware oriented to process videos on CPU, so switching to GPU will negatively affect performance, but that's just my guess. Another possibility is that they still treat GPU rendering as experimental feature that's not stable enough to set it as a default yet. You don't want to waste hours rendering your video just to realize something is screwed up due to GPU rendering bug. If you decide to use it anyway, then you can't blame the software publisher - it was your decision.
    > 

- [How a GPU Works](https://www.cs.cmu.edu/afs/cs/academic/class/15462-f11/www/lec_slides/lec19.pdf)

    ![](https://screenshotscdn.firefoxusercontent.com/images/66d590a0-f112-4f68-9e6b-0a5840ef6025.png)

## 3D 建模

### GQN Neural rendering

<iframe width="560" height="315" src="https://www.youtube.com/embed/gnctSz2ofU4" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

- [Neural scene representation and rendering | DeepMind](https://deepmind.com/blog/neural-scene-representation-and-rendering/)

- [自动「脑补」3D环境！DeepMind最新Science论文提出生成查询网络GQN | 机器之心](https://www.jiqizhixin.com/articles/Science-Neural-scene-representation-and-rendering)


    > 在这项发表在 Science 的研究中，DeepMind 引入了生成查询网络（Generative Query Network/GQN）的框架，其中机器通过到处走动并仅在由它们自己获取的数据中训练来感知周围环境。该行为和婴儿、动物很相似，GQN 通过尝试观察周围的世界并进行理解来学习。以此，GQN 得以学习合理的场景以及它们的几何性质，而不需要任何场景内容的人类标记。
    > 
    > GQN 模型由两部分构成：一个表征网络以及一个生成网络。表征网络将智能体的观察作为输入，并生成一个描述潜在场景的表征（向量）。然后生成网络从之前未观察过的视角来预测（想象）该场景。
    > 
    > 表征网络不知道生成网络将被要求预测哪些视角，因此必须找到尽可能准确描述场景真实布局的有效方法。表征网络能通过简明的分布式表示捕获最重要的元素，例如目标位置、颜色和房间布局。在训练过程中，生成器学习环境中的典型目标、特征、关系和规律。这组共享的「概念」使表征网络能够以高度压缩、抽象的方式来描述场景，让生成网络在必要时填写细节。例如，表征网络将把「蓝色立方体」简洁地表示为一个小的数值集合，生成网络将知道从特定的角度来看，这是如何以像素的形式表现出来的。
    > 
    > 我们在模拟 3D 世界里一组由程序生成的环境中对 GQN 进行了受控实验，这些环境包含随机位置、颜色、形状和纹理的多个目标，还有随机光源和严重遮挡。在这些环境下训练后，我们使用 GQN 的表征网络来生成新的、以前未见过的视角下的场景表征。我们在实验中表明，GQN 具有几个重要的特性：
    > 
    > -   GQN 的生成网络可以从新的视角非常精确地「想象」以前未见过视角下的场景。当给定场景表征和新视角时，它会生成清晰的图像，而不需要预先规定角度、遮挡或照明的规律。因此，生成网络是从数据中学习的近似渲染器（renderer）：
    > 
    > ![](https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8ymzWBzccLf3HS5gOQrALlns7f5ax0aicgiaJSVrSI6we8kgQcjPCiaWAJfBa82CoNtCfdl493WibwJA/640?wx_fmt=png&wxfrom=5&wx_lazy=1)
    > 
    > -   GQN 的表征网络可以学习计数、定位和分类目标，并且不需要任何目标级的标注。即使它的表征可能是很小的，GQN 在查询视角的预测也能达到很高的准确率，几乎和真实场景无法分辨。这意味着该表征网络可以准确地感知，例如识别积木块的精确配置：
    > 
    > ![](https://mmbiz.qpic.cn/mmbiz_gif/KmXPKA19gW8ymzWBzccLf3HS5gOQrALl3gxSZnKh4STsRmTq3GicPAj8oxwXLz2WGFzdLH6nuGn9ic8clc64rNvw/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)
    > 
    > -   GQN 可以表征、测量和减少不确定性。它可以计算关于场景可信度的不确定度，即使其内容不是完全可见的，并且它可以组合一个场景的多个部分视角来构建一致的整体。下图中展示了它的第一人称视角和自顶向下视角的预测。该模型通过预测的易变性来表达不确定度，并随着它在迷宫中移动而逐渐减小（灰色椎体表示观察位置，黄色椎体表示查询位置）。
    > 
    > ![](https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8ymzWBzccLf3HS5gOQrALlmibDblbAZ3cmm6ydBMUQbe7e3MeDDK93lHDZiaacIKvVvJQ52XW96YKQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1)
    > 
    > -   GQN 的表征允许实现鲁棒性的、数据效率高的强化学习。当给定 GQN 的紧凑型表征时，如下所示，当前最优的深度强化学习智能体相比于 model-free 的基线智能体在学习完成任务上有更高的数据效率。对于这些智能体，通用网络中编码的信息能被视为环境的先验知识：
    > 
    > ![](https://mmbiz.qpic.cn/mmbiz_png/KmXPKA19gW8ymzWBzccLf3HS5gOQrALlI5ZDO1ZvEqELkqwU2TJ1IeItRXBKXwHfDyiag37Niaql5GSIxr7Q2TMQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1)
    > 
    > *相比于使用原像素的标准方法，使用 GQN 迭代次数少了 4 倍，但收敛表现一致且有更加数据高效的策略学习。*
    > 
    > GQN 建立在最近大量多视角的几何研究、生成式建模、无监督学习和预测学习的基础上，它展示了一种学习物理场景的紧凑、直观表征的全新方式。重要的是，提出的这种方法不需要特定域的工程以及消耗时间对场景内容打标签，使得同一模型能够应用到大量不同的环境。它也学习了一种强大的神经渲染器，能够产生准确的、全新视角的场景图像。
    > 
    > DeepMind 认为，相比于更多传统的计算机视觉技术，他们的方法还有许多缺陷，目前也只在合成场景下训练工作的。然而，随着新数据资源的产生、硬件能力的发展，DeepMind 希望探索 GQN 框架应用到更高分辨率真实场景图像的研究。未来，探索 GQN 应用到更广泛的场景理解的工作也非常重要，例如通过跨空间和时间的查询来学习物理和移动等常识概念，还有应用到虚拟和增强现实等。
    > 


### Photo realistic Neural rendering

- [Gaussian Material Synthesis – new! ACM Transactions on Graphics (SIGGRAPH 2018) Károly Zsolnai-Fehér, Peter Wonka, Michael Wimmer – Károly Zsolnai-Fehér – Research Scientist](https://users.cg.tuwien.ac.at/zsolnai/gfx/gaussian-material-synthesis/)

    <iframe width="560" height="315" src="https://www.youtube.com/embed/6FzVhIV_t3s" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

    > In this paper, we teach an AI the concept of metallic, translucent materials and more. The newly synthesized materials can be visualized in real-time via neural rendering and we also propose an intuitive variant generation technique to enable the user to fine-tune these recommended materials. This project took more than 3000 work hours to complete – I hope you’ll enjoy the result!
    > 

### 共面性3D重建

- [ECCV 2018 | 國防科大&普林斯頓提出共面性檢測網絡：助力三維場景重建 - 幫趣](http://bangqu.com/611o8q.html)

    > 在此之前，傳統方法往往通過檢測不同圖片中的共同特徵點來實現圖片配準。但是由於圖片曝光不統一、相機運動太快導致圖像模糊等因素，關鍵點的檢測和特徵計算差強人意，基於特徵點的配准算法有很強的侷限性。
    > 
    > 爲了解決這一問題，人們開始嘗試利用較特徵點更大的幾何體來提高三維場景重建的精度。過去的五年裏，這方面的研究工作大多集中於利用平面的共面性對配準結果進行優化矯正。以 CVPR 2017 文章 [1] 中的方法爲例，該方法首先利用 SIFT 特徵點實現初步配準，然後通過將近似共面平面矯正成完全共面平面來優化相機位置。這種遞進式的優化方法雖然能夠在一定程度上提高三維場景重建精度，但是卻嚴重依賴於對相機位姿的初始估計。當初始位姿誤差很大的時候，該方法無法正確檢測幀間的共面平面，從而帶來巨大的重建誤差。那麼，如何才能更好地利用平面提高三維重建精度呢？
    > 
    > ![](http://i2.bangqu.com/j/news/20180810/611o8q1533877229321f2U6o.png)*圖 2 平面共面性預測*
    > 
    > 「我們注意到，人類在判斷兩個平面是否共面時並不需要估計相機的位姿。爲了解決上述問題，一個很直接的想法是讓機器具有像人類一樣對共面性進行判斷的能力。我們提出使用深度網絡預測不同幀中的兩個平面是否共面，這在三維重建領域尚屬首次。」論文的第一作者施逸飛這樣介紹這項工作。「人類在做這種判斷時，既會觀察兩個平面的紋理顏色是否一致，也會考慮平面的語義信息。例如，假設我知道兩個平面都是地面，那麼它們極有可能是共面的。」
    > 
    > ![](http://i2.bangqu.com/j/news/20180810/611o8q1533877230596C1m1D.png)*圖 3 PlaneMatch 算法流程圖*

